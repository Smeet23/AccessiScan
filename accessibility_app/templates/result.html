{% extends 'base.html' %}

{% block title %}Accessibility Analysis Results{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Input Info -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-6">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">Accessibility Analysis Results</h2>
        
        <div class="mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Input Information</h3>
            <div class="mt-2">
                <p><span class="font-medium">Input Type:</span> {{ input_type|title }}</p>
                {% if input_type == 'url' %}
                <p>
                    <span class="font-medium">URL:</span> 
                    <a href="{{ input_data }}" target="_blank" class="text-indigo-600 hover:underline">
                        {{ input_data }}
                    </a>
                </p>
                {% else %}
                <p><span class="font-medium">HTML Content:</span> <span class="text-gray-500">(HTML content provided)</span></p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Summary Section -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-6">
        <h3 class="text-xl font-semibold mb-4 text-gray-800">Summary</h3>
        
        <div class="flex flex-wrap gap-4">
            <div class="bg-gray-100 p-4 rounded-lg text-center flex-1">
                <div class="text-3xl font-bold text-gray-800">{{ analysis.summary.total_violations }}</div>
                <div class="text-gray-600">Total Issues</div>
            </div>
            
            <div class="bg-red-100 p-4 rounded-lg text-center flex-1">
                <div class="text-3xl font-bold text-red-700">{{ analysis.summary.critical }}</div>
                <div class="text-red-700">Critical</div>
            </div>
            
            <div class="bg-yellow-100 p-4 rounded-lg text-center flex-1">
                <div class="text-3xl font-bold text-yellow-700">{{ analysis.summary.serious }}</div>
                <div class="text-yellow-700">Serious</div>
            </div>
            
            <div class="bg-blue-100 p-4 rounded-lg text-center flex-1">
                <div class="text-3xl font-bold text-blue-700">{{ analysis.summary.moderate }}</div>
                <div class="text-blue-700">Moderate</div>
            </div>
            
            <div class="bg-green-100 p-4 rounded-lg text-center flex-1">
                <div class="text-3xl font-bold text-green-700">{{ analysis.summary.minor }}</div>
                <div class="text-green-700">Minor</div>
            </div>
        </div>
    </div>
    
    <!-- Violations Section -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-xl font-semibold mb-4 text-gray-800">Accessibility Issues</h3>
        
        {% if analysis.violations %}
            <div class="space-y-6">
                {% for violation in analysis.violations %}
                    <div class="border rounded-lg overflow-hidden">
                        <!-- Violation Header -->
                        <div class="p-4 border-b bg-gray-50 flex justify-between items-center">
                            <div>
                                <h4 class="text-lg font-semibold">{{ violation.id }}</h4>
                                <p class="text-gray-700">{{ violation.description }}</p>
                            </div>
                            <div>
                                <span class="inline-block px-3 py-1 rounded-full text-white font-medium text-sm impact-{{ violation.impact }}">
                                    {{ violation.impact|title }}
                                </span>
                            </div>
                        </div>
                        
                        <!-- Violation Nodes -->
                        <div class="p-4 divide-y">
                            {% for node in violation.nodes %}
                                <div class="py-4 {% if not forloop.first %}pt-4{% endif %}">
                                    <h5 class="font-semibold mb-2">HTML Element</h5>
                                    <div class="code-block mb-4">{{ node.html }}</div>
                                    
                                    <h5 class="font-semibold mb-2">Suggestions</h5>
                                    <ul class="list-disc pl-5 space-y-1">
                                        {% for suggestion in node.suggestions %}
                                            <li>{{ suggestion }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endfor %}
                        </div>
                        
                        <!-- Help Info -->
                        <div class="p-4 bg-gray-50 border-t">
                            <p class="font-semibold">{{ violation.help }}</p>
                            <a href="{{ violation.helpUrl }}" target="_blank" class="text-indigo-600 hover:underline">
                                Learn more about this issue
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="bg-green-100 p-4 rounded-lg">
                <p class="text-green-700">No accessibility issues were found.</p>
            </div>
        {% endif %}
    </div>
    
    <!-- Download PDF Button -->
    <div class="mt-6 text-center">
        <a href="{% url 'accessibility_app:generate_pdf' analysis_id=analysis_id %}" class="inline-block bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-6 rounded-md transition duration-300">
            Download PDF
        </a>
        
    </div>
    
    <!-- Back Button -->
    <div class="mt-6 text-center">
        <a href="{% url 'accessibility_app:home' %}" class="inline-block bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-6 rounded-md transition duration-300">
            Analyze Another Page
        </a>
    </div>
</div>
{% endblock %}
